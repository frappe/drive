import{z as g,b as y,E as _,f,G as x,H as k,g as d,h as n,i as l,k as a,w as v,c as w,F as h,I as C,J as T,K as B,q as N,o as u,T as R,l as S,M as V}from"./index-ab38d1de.js";import{_ as j}from"./ListView-0d2fff1d.js";const L={class:"bg-surface-white border-b w-full px-5 py-2.5 h-12 flex items-center justify-between"},$={class:"bg-surface-gray-2 rounded-[10px] space-x-0.5 h-7 flex items-center px-0.5 py-1"},z={key:1,class:"flex flex-col items-center justify-center m-auto min-h-full overflow-auto",style:{transform:"translate(0, -42px)"}},U={__name:"Notifications",setup(A){const i=g(),o=y(!0),p={getRowRoute:e=>({name:e.entity_type,params:{entityName:e.notif_doctype_name}}),onRowClick:e=>{e.type==="Team"&&C.emit("showSettings",1),o.value&&(c.submit({name:e.name}),i.state.notifCount=i.state.notifCount-1)},selectable:!1,showTooltip:!0,resizeColumn:!1},b=[{label:"Subject",key:"subject",width:"80px",getLabel:({row:e})=>e.type},{label:"Message",key:"message",width:4,getLabel:({row:e})=>e.message,prefix:({row:e})=>{if(e.from_user)return T(B,{shape:"circle",label:e.from_user,image:e.user_image,size:"sm"})}},{key:"creation",align:"end",getLabel:({row:e})=>e.relativeTime}];_(o,e=>{s.fetch({only_unread:e})});const s=f({url:"drive.api.notifications.get_notifications",auto:!0,params:{only_unread:o.value},onSuccess(e){e.forEach(t=>{t.relativeTime=x(new Date(t.creation)),t.creation=k(t.creation)})}}),c=f({url:"drive.api.notifications.mark_as_read",auto:!1,method:"POST",params:{name:"",all:!1},onSuccess(){s.reload()}});return(e,t)=>{const m=N("Button");return u(),d(h,null,[n("div",L,[n("div",$,[l(a(R),{modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=r=>o.value=r),buttons:[{label:"Unread",value:!0},{label:"All",value:!1}]},null,8,["modelValue"])]),n("div",null,[l(m,{loading:a(s).loading,icon:"refresh-ccw",class:"mr-2",onClick:t[1]||(t[1]=r=>a(s).reload())},null,8,["loading"]),l(m,{"icon-left":"check-circle",onClick:t[2]||(t[2]=r=>(a(c).submit({all:!0}),a(i).state.notifCount=0))},{default:v(()=>[...t[3]||(t[3]=[S(" Mark all as Read ",-1)])]),_:1})])]),a(s).data?.length?(u(),w(a(j),{key:0,class:"px-5 pt-5",columns:b,options:p,rows:a(s).data,"row-key":"name"},null,8,["rows"])):(u(),d("div",z,[l(a(V),{class:"w-14 h-auto text-ink-gray-4 pb-4"}),t[4]||(t[4]=n("span",{class:"text-base text-ink-gray-5 font-medium"},"No Notifications",-1))]))],64)}}};export{U as default};
//# sourceMappingURL=Notifications-0c229efe.js.map
