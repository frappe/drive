import{_ as H,o as i,c as A,w as u,r as I,m as M,a as O,u as j,b as n,d as G,e as W,f as _,t as w,s as z,g as d,h as o,i as l,j as c,k as t,F as $,l as m,n as B,p as K,q as D,v as Y,x as y,y as Q}from"./index-4c7db8d6.js";const X={props:["to"],computed:{attributes(){return{...this.$attrs,target:this.isExternal?"_blank":null,to:this.isExternal?void 0:this.to,href:this.isExternal?this.to:void 0}},isExternal(){return this.to.startsWith("http")}}};function Z(q,E,p,k,x,v){return i(),A(O(v.isExternal?"a":"router-link"),M(v.attributes,{class:"cursor-pointer text-blue-500 hover:text-blue-600"}),{default:u(()=>[I(q.$slots,"default")]),_:3},16)}const ee=H(X,[["render",Z]]),te={class:"flex h-screen w-full overflow-hidden sm:bg-surface-menu-bar"},ae={class:"w-full overflow-auto"},oe={class:"relative h-full"},se={class:"relative z-10 mx-auto pt-8 sm:w-max sm:pt-20"},le={class:"flex flex-col items-center"},ne={class:"mx-auto w-full bg-surface-white px-4 p-8 sm:mt-6 sm:w-112 sm:rounded-2xl sm:px-6 py-6 sm:shadow-2xl"},ie={class:"mb-7.5 text-center"},re={class:"mb-2 text-2xl font-semibold leading-6 text-ink-gray-9"},ue={class:"break-words text-base font-normal leading-[21px] text-ink-gray-7"},de={class:"flex flex-col"},ce={class:"mt-5 flex flex-row gap-5"},me={class:"!mt-6 flex gap-2"},pe={class:"text-base"},ve={class:"mt-8 flex flex-col items-center gap-3"},fe={key:1},ge={key:0,class:"mt-6 border-t text-center"},_e={class:"flex items-center"},xe=["innerHTML"],be={class:"ml-2"},he={key:0,class:"mt-6 text-center"},ye={__name:"LoginSignup",setup(q){const E=j(),p=new URLSearchParams(new URL(window.location.href).search),k=n(p.get("e")||""),x=n(""),v=n(""),V=n(!1),L=n(""),f=n(0),g=n(p.get("r")||""),P=n(g.value!==""),S=n(g.value!==""),r=G(()=>E.name==="Login");W(()=>{setInterval(()=>{f.value>0&&(f.value-=1)},1e3)});const F=()=>{const s=location.search;return new URLSearchParams(s).get("referrer")},R=_({url:"drive.api.product.signup_disabled",cache:"signupDisabled",auto:!0}),N=_({url:"drive.api.product.signup",makeParams:()=>({account_request:g.value,first_name:x.value,last_name:v.value,referrer:F()}),validate(){if(!V.value)throw new Error("Please accept the terms of service")},onSuccess(s){window.location.href=s.location},onError(s){s.exc_type==="DuplicateEntryError"?w("Account already exists - please login."):w("Failed to create account")}}),U=_({url:"drive.api.product.oauth_providers",auto:!0}),T=_({url:"drive.api.product.google_login",onSuccess(s){window.location.href=s}}),C=_({url:"drive.api.product.send_otp",onSuccess(s){P.value=!0,f.value=30,g.value=s.message||s,w("Verification code sent to your email")},onError(s){JSON.stringify(s).includes("not found")?w(R.data?"You do not have an account on this site.":"Please sign up first!"):w("Failed to send verification code")}}),b=_({url:"drive.api.product.verify_otp",onSuccess:s=>{S.value=!0,z.fetch(),s.location&&window.location.replace(s.location)}});return(s,e)=>{const h=D("Button"),J=D("router-link");return i(),d("div",te,[o("div",ae,[o("div",oe,[o("div",se,[o("div",le,[l(Y,{class:"inline-block h-12 w-12 rounded-md"})]),o("div",ne,[o("div",ie,[o("p",re,c(r.value?"Login to Drive":t(p).get("t")?"Join "+t(p).get("t"):"Create a new account"),1),o("p",ue,c(r.value?"Welcome back!":t(p).get("t")?"Powered by Frappe Drive.":"Get 5 GB for free, no credit card required."),1)]),o("form",de,[l(t(y),{modelValue:k.value,"onUpdate:modelValue":e[0]||(e[0]=a=>k.value=a),label:"Email",type:"email",placeholder:"johndoe@mail.com",autocomplete:"email",disabled:P.value,required:""},null,8,["modelValue","disabled"]),S.value&&!r.value?(i(),d($,{key:0},[o("div",ce,[l(t(y),{modelValue:x.value,"onUpdate:modelValue":e[1]||(e[1]=a=>x.value=a),label:"First Name",type:"text",placeholder:"Robin",variant:"outline",required:""},null,8,["modelValue"]),l(t(y),{modelValue:v.value,"onUpdate:modelValue":e[2]||(e[2]=a=>v.value=a),label:"Last Name",type:"text",placeholder:"Hood",variant:"outline"},null,8,["modelValue"])]),o("div",me,[l(t(y),{modelValue:V.value,"onUpdate:modelValue":e[3]||(e[3]=a=>V.value=a),type:"checkbox"},null,8,["modelValue"]),o("label",pe,[e[11]||(e[11]=m(" I accept the ",-1)),l(t(ee),{class:"!text-ink-gray-7",to:"https://frappecloud.com/policies",target:"_blank"},{default:u(()=>[...e[10]||(e[10]=[m(" Terms and Policies ",-1)])]),_:1})])]),o("div",ve,[l(h,{loading:t(N).loading,disabled:!x.value.length||!V.value,variant:"solid",class:"w-full font-medium",onClick:e[4]||(e[4]=a=>t(N).submit())},{default:u(()=>[...e[12]||(e[12]=[m(" Create Account ",-1)])]),_:1},8,["loading","disabled"])])],64)):P.value?(i(),d("div",fe,[l(t(y),{modelValue:L.value,"onUpdate:modelValue":e[5]||(e[5]=a=>L.value=a),label:"Verification code",type:"text",class:"mt-4",placeholder:"123456",disabled:t(b).loading,maxlength:"6",required:"",onKeyup:e[6]||(e[6]=a=>a.target.value.length===6&&t(b).submit({account_request:g.value,otp:L.value}))},null,8,["modelValue","disabled"]),l(t(Q),{class:"mt-4 text-center",message:t(b).error},null,8,["message"]),l(h,{class:"mt-4 w-full",variant:"solid",loading:t(b).loading,onClick:e[7]||(e[7]=a=>t(b).submit({account_request:g.value,otp:L.value}))},{default:u(()=>[...e[13]||(e[13]=[m(" Verify ",-1)])]),_:1},8,["loading"]),l(h,{class:"mt-2 w-full",variant:"outline",loading:t(C).loading,disabled:f.value>0,onClick:e[8]||(e[8]=a=>t(C).submit())},{default:u(()=>[m(" Resend verification code "+c(f.value>0?`in ${f.value} seconds`:""),1)]),_:1},8,["loading","disabled"])])):(i(),d($,{key:2},[l(h,{class:"mt-4",loading:t(C).loading,variant:"solid",onClick:e[9]||(e[9]=a=>t(C).submit({email:k.value,login:r.value}))},{default:u(()=>[m(c(r.value?"Login":"Join"),1)]),_:1},8,["loading"]),t(U).data?.length?(i(),d("div",ge,[...e[14]||(e[14]=[o("div",{class:"-translate-y-1/2 transform"},[o("span",{class:"relative bg-surface-white px-2 text-sm font-medium leading-8 text-ink-gray-8"}," or ")],-1)])])):B("",!0),(i(!0),d($,null,K(t(U).data,a=>(i(),A(h,{key:a.name,class:"mb-2",loading:t(T).loading,link:a.auth_url},{default:u(()=>[o("div",_e,[o("div",{innerHTML:a.icon},null,8,xe),o("span",be,c(r.value?"Continue":"Join")+" with "+c(a.provider_name),1)])]),_:2},1032,["loading","link"]))),128))],64))]),t(R).data?B("",!0):(i(),d("div",he,[l(J,{class:"text-center text-sm text-ink-gray-8 hover:text-ink-gray-9",to:{name:r.value?"Signup":"Login",query:{...s.$route.query,forgot:void 0}}},{default:u(()=>[m(c(r.value?"New member? Create a new account.":"Already have an account? Log in."),1)]),_:1},8,["to"])]))])])])])])}}};export{ye as default};
//# sourceMappingURL=LoginSignup-f01d12ba.js.map
