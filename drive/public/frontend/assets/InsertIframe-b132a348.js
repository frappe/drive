import{aj as P,b as s,d as i,dI as x,dJ as V,dK as D,dL as j,dM as O,dN as S,e as T,c5 as W,o as b,g,r as $,bi as B,bj as H,i as c,w as m,h as v,k as f,dO as K,cf as z,j as R,n as G,aw as _,l as C,b0 as F,bZ as J}from"./index-a1f5a1ea.js";const Z={class:"space-y-4"},q={key:0,class:"text-red-500 text-sm mt-1"},Q={key:1,class:"text-ink-green-3 text-sm mt-1"},X={class:"flex justify-end space-x-2"},ee=P({__name:"InsertIframe",props:{editor:{}},setup(E){const n=E,r=s(!1),e=s(""),o=s(""),I=s(""),k=s("center"),p=s(640),h=s(360),w=s(),l=i(()=>{if(!e.value)return!1;try{if(e.value.trim().startsWith("<iframe")){const t=e.value.match(/src=["']([^"']+)["']/);return t?.[1]?x(t[1],{allowedDomains:V,HTMLAttributes:{}}):!1}return x(e.value,{allowedDomains:V,HTMLAttributes:{}})}catch{return!1}}),u=i(()=>{if(!e.value)return"";if(e.value.trim().startsWith("<iframe")){const t=e.value.match(/src=["']([^"']+)["']/);return t?.[1]?D(t[1]):e.value}return D(e.value)}),M=i(()=>{if(!e.value||!l.value)return{platform:"Generic",aspectRatio:9/16};const t=j(u.value),a=O(u.value);return{platform:t?.name||"Generic",aspectRatio:a.ratio}}),N=i(()=>!e.value||!l.value?{width:640,height:360}:S(u.value,800));function A(){o.value="",e.value&&(l.value||(o.value="Please enter a supported URL or iframe embed code"))}function y(){r.value=!0,e.value="",o.value="",I.value="",k.value="center",p.value=640,h.value=360,J(()=>{w.value?.el?.focus()})}i(()=>{if(e.value&&l.value){const t=N.value;p.value=t.width,h.value=t.height}});function L(){if(!e.value||!l.value)return;n.editor.commands.setIframe({src:u.value,width:p.value,height:h.value,title:I.value,align:k.value})?(r.value=!1,n.editor.commands.focus()):o.value="Failed to insert embed. Please check the URL and try again."}function U(t){t.detail?.editor===n.editor&&y()}return T(()=>{n.editor.view.dom.addEventListener("iframe:open-dialog",U)}),W(()=>{n.editor.view.dom.removeEventListener("iframe:open-dialog",U)}),(t,a)=>(b(),g("div",null,[$(t.$slots,"default",B(H({onClick:y}))),c(f(F),{modelValue:r.value,"onUpdate:modelValue":a[2]||(a[2]=d=>r.value=d),options:{title:"Insert Embed",size:"md"}},{"body-content":m(()=>[v("div",Z,[v("div",null,[a[3]||(a[3]=v("label",{class:"block text-sm font-medium text-ink-gray-7 mb-2"}," URL or Embed Code ",-1)),c(f(K),{ref_key:"urlInput",ref:w,modelValue:e.value,"onUpdate:modelValue":a[0]||(a[0]=d=>e.value=d),placeholder:"https://youtube.com/watch?v=... or <iframe src=...>",onKeydown:z(L,["enter"]),onInput:A},null,8,["modelValue"]),o.value?(b(),g("p",q,R(o.value),1)):e.value&&l.value?(b(),g("p",Q," âœ“ Valid "+R(M.value.platform)+" URL ",1)):G("",!0)])])]),actions:m(()=>[v("div",X,[c(f(_),{variant:"subtle",onClick:a[1]||(a[1]=d=>r.value=!1)},{default:m(()=>[...a[4]||(a[4]=[C("Cancel",-1)])]),_:1}),c(f(_),{variant:"solid",disabled:!e.value||!l.value,onClick:L},{default:m(()=>[...a[5]||(a[5]=[C(" Insert Embed ",-1)])]),_:1},8,["disabled"])])]),_:1},8,["modelValue"])]))}});export{ee as default};
//# sourceMappingURL=InsertIframe-b132a348.js.map
