{"version":3,"file":"Setup-38ffd43d.js","sources":["../../../../frontend/src/pages/Setup.vue"],"sourcesContent":["<template>\n  <div class=\"flex h-screen w-full overflow-hidden sm:bg-surface-menu-bar\">\n    <div class=\"w-full overflow-auto\">\n      <div class=\"relative h-full\">\n        <div class=\"relative z-10 mx-auto pt-8 sm:w-max sm:pt-20\">\n          <div\n            class=\"flex flex-col items-center\"\n            @dblclick=\"window.location.href = '/f-login'\"\n          >\n            <FrappeDriveLogo class=\"inline-block h-12 w-12 rounded-md\" />\n          </div>\n          <div\n            class=\"mx-auto w-full bg-surface-white px-4 py-8 sm:mt-6 sm:w-112 sm:rounded-2xl sm:px-6 sm:py-6 sm:shadow-2xl\"\n          >\n            <div class=\"mb-7.5 text-center\">\n              <p class=\"mb-2 text-2xl font-semibold leading-6 text-ink-gray-9\">\n                Welcome to Drive\n              </p>\n              <p\n                class=\"break-words text-base font-normal leading-[21px] text-ink-gray-7\"\n              >\n                We're glad you're here.\n              </p>\n            </div>\n\n            <div\n              v-if=\"domainTeams.loading\"\n              class=\"flex justify-center py-8\"\n            >\n              <div\n                class=\"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary-600\"\n              />\n            </div>\n            <div\n              v-else-if=\"!domainTeams.data\"\n              class=\"flex flex-col py-5 gap-3\"\n            >\n              <LoadingIndicator class=\"size-5 self-center\" />\n              <div class=\"text-sm text-center\">\n                Just a minute...\n              </div>\n            </div>\n            <div\n              v-else-if=\"domainTeams.data.length\"\n              class=\"flex flex-col text-md gap-2\"\n            >\n              <p>\n                We noticed that you are on a\n                <strong>corporate domain</strong>.\n              </p>\n              <p v-if=\"domainTeams.data.length\">\n                Do you want to create a personal account, or request to join the\n                team (<strong>{{ domainTeams.data[0].title }}</strong>) associated with your domain?\n              </p>\n              <p v-else>\n                Do you want to create a personal account, or create a team with\n                your domain?\n              </p>\n              <FormControl\n                v-if=\"typeof team_name === 'string'\"\n                v-model=\"team_name\"\n                label=\"Team Name\"\n                class=\"py-2\"\n                type=\"text\"\n                required\n              />\n              <div class=\"flex justify-between mt-3\">\n                <Button\n                  variant=\"subtle\"\n                  class=\"w-100\"\n                  @click=\"createTeam.submit()\"\n                >\n                  Create Personal\n                </Button>\n                <Button\n                  v-if=\"domainTeams.data.length\"\n                  variant=\"solid\"\n                  @click=\"\n                    requestInvite.submit({\n                      team: domainTeams.data[0].name,\n                    }),\n                    $router.replace({ path: '/drive/teams' })\n                  \"\n                >\n                  Join {{ domainTeams.data[0].title }}\n                </Button>\n                <Button\n                  v-else\n                  variant=\"solid\"\n                  @click=\"\n                    typeof team_name === 'string'\n                      ? createTeam.submit({ team_name, email })\n                      : (team_name = '')\n                  \"\n                >\n                  Create Team\n                </Button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { createResource, FormControl } from \"frappe-ui\"\nimport { ref, computed } from \"vue\"\nimport FrappeDriveLogo from \"@/components/FrappeDriveLogo.vue\"\nimport { useStore } from \"vuex\"\nimport LoadingIndicator from \"frappe-ui/src/components/LoadingIndicator.vue\"\nimport { createTeam } from \"@/resources/permissions\"\n\nconst store = useStore()\nconst team_name = ref(null)\nconst email = computed(() => store.state.user.id)\n\nconst domainTeams = createResource({\n  url: \"drive.api.product.get_domain_teams\",\n  auto: true,\n  params: {\n    domain: email.value.split(\"@\").slice(-1)[0],\n  },\n  onSuccess(data) {\n    if (data === false)\n      createTeam.submit(\n        { personal: 1 },\n        {\n          onSuccess,\n        }\n      )\n  },\n})\n\nconst onSuccess = (data) => {\n  if (data) {\n    window.location.replace(\"/drive\")\n  } else {\n    window.location.reload()\n  }\n}\n\nconst requestInvite = createResource({\n  url: \"drive.api.product.request_invite\",\n  onSuccess: () => {\n    window.location.replace(\"/drive/teams\")\n  },\n})\n</script>\n"],"names":["store","useStore","team_name","ref","email","computed","domainTeams","createResource","data","createTeam","onSuccess","requestInvite","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_hoisted_4","window","_createVNode","FrappeDriveLogo","_hoisted_5","_unref","_hoisted_6","_cache","_hoisted_8","_hoisted_9","_toDisplayString","_createBlock","FormControl","$event","_hoisted_11","_component_Button","$router","_createTextVNode","_hoisted_7","LoadingIndicator"],"mappings":"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"}